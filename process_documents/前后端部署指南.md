# ğŸš€ ä¸€å»ºæœºç”µå¤‡è€ƒ AI åŠ©æ‰‹ - å‰åç«¯éƒ¨ç½²æŒ‡å—

## ğŸ“‹ é¡¹ç›®æ¶æ„

æœ¬é¡¹ç›®é‡‡ç”¨å‰åç«¯åˆ†ç¦»æ¶æ„ï¼š

- **åç«¯**: Python Flask API æœåŠ¡å™¨
- **å‰ç«¯**: React + Vite å•é¡µåº”ç”¨
- **æ•°æ®åº“**: ChromaDB å‘é‡æ•°æ®åº“
- **AIæ¨¡å‹**: DeepSeek API (å…¼å®¹ OpenAI API)

```
kaoLong/
â”œâ”€â”€ backend (Python)
â”‚   â”œâ”€â”€ api_server.py          # Flask API æœåŠ¡å™¨
â”‚   â”œâ”€â”€ ai_agent.py            # AI Agent æ ¸å¿ƒ
â”‚   â”œâ”€â”€ knowledge_base.py      # çŸ¥è¯†åº“ç®¡ç†
â”‚   â”œâ”€â”€ pdf_parser.py          # PDF è§£æ
â”‚   â”œâ”€â”€ init_knowledge_base.py # çŸ¥è¯†åº“åˆå§‹åŒ–
â”‚   â”œâ”€â”€ requirements.txt       # Python ä¾èµ–
â”‚   â”œâ”€â”€ .env                   # ç¯å¢ƒå˜é‡é…ç½®
â”‚   â””â”€â”€ data/                  # æ•°æ®ç›®å½•
â”‚       â””â”€â”€ chroma_db/         # å‘é‡æ•°æ®åº“
â”‚
â””â”€â”€ frontend (React)
    â”œâ”€â”€ src/
    â”‚   â”œâ”€â”€ App.jsx            # ä¸»åº”ç”¨ç»„ä»¶
    â”‚   â”œâ”€â”€ App.css            # æ ·å¼æ–‡ä»¶
    â”‚   â”œâ”€â”€ main.jsx           # å…¥å£æ–‡ä»¶
    â”‚   â””â”€â”€ index.css          # å…¨å±€æ ·å¼
    â”œâ”€â”€ package.json           # Node.js ä¾èµ–
    â””â”€â”€ vite.config.js         # Vite é…ç½®
```

---

## ğŸ”§ ç¯å¢ƒè¦æ±‚

### åç«¯è¦æ±‚
- Python 3.8+
- pip (Python åŒ…ç®¡ç†å™¨)

### å‰ç«¯è¦æ±‚
- Node.js 20.19+ æˆ– 22.12+
- npm æˆ– yarn

### æ¨èå·¥å…·
- nvm (Node ç‰ˆæœ¬ç®¡ç†å™¨)
- Python venv (è™šæ‹Ÿç¯å¢ƒ)

---

## ğŸ“¦ å®‰è£…æ­¥éª¤

### 1. åç«¯å®‰è£…

#### 1.1 åˆ›å»ºå¹¶æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ

```bash
cd Desktop/kaoLong
python3 -m venv venv
source venv/bin/activate  # macOS/Linux
# æˆ–
venv\Scripts\activate  # Windows
```

#### 1.2 å®‰è£… Python ä¾èµ–

```bash
pip install -r requirements.txt
```

#### 1.3 é…ç½®ç¯å¢ƒå˜é‡

ç¼–è¾‘ `.env` æ–‡ä»¶ï¼š

```bash
# OpenAI API é…ç½®
OPENAI_API_KEY=ä½ çš„APIå¯†é’¥
OPENAI_BASE_URL=https://api.deepseek.com/v1
OPENAI_MODEL=deepseek-chat

# API æœåŠ¡å™¨é…ç½®ï¼ˆå¯é€‰ï¼‰
API_HOST=0.0.0.0
API_PORT=5001
API_DEBUG=False
```

#### 1.4 åˆå§‹åŒ–çŸ¥è¯†åº“

```bash
python init_knowledge_base.py
```

è¿™å°†è§£ææ‰€æœ‰ PDF æ•™æå¹¶æ„å»ºå‘é‡æ•°æ®åº“ï¼ˆçº¦éœ€ 3-5 åˆ†é’Ÿï¼‰ã€‚

### 2. å‰ç«¯å®‰è£…

#### 2.1 åˆ‡æ¢ Node.js ç‰ˆæœ¬ï¼ˆå¦‚æœéœ€è¦ï¼‰

```bash
# ä½¿ç”¨ nvm å®‰è£…å¹¶åˆ‡æ¢åˆ° Node.js 22
source ~/.nvm/nvm.sh
nvm install 22
nvm use 22
```

#### 2.2 å®‰è£…å‰ç«¯ä¾èµ–

```bash
cd frontend
npm install
```

---

## ğŸš€ å¯åŠ¨æœåŠ¡

### æ–¹å¼ä¸€ï¼šåˆ†åˆ«å¯åŠ¨ï¼ˆå¼€å‘æ¨¡å¼ï¼‰

#### å¯åŠ¨åç«¯ API æœåŠ¡å™¨

```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•
cd Desktop/kaoLong
source venv/bin/activate
python api_server.py
```

åç«¯æœåŠ¡å°†åœ¨ `http://localhost:5001` å¯åŠ¨

#### å¯åŠ¨å‰ç«¯å¼€å‘æœåŠ¡å™¨

```bash
# åœ¨å¦ä¸€ä¸ªç»ˆç«¯
cd Desktop/kaoLong/frontend
source ~/.nvm/nvm.sh && nvm use 22
npm run dev
```

å‰ç«¯æœåŠ¡å°†åœ¨ `http://localhost:5173` å¯åŠ¨

### æ–¹å¼äºŒï¼šä½¿ç”¨å¯åŠ¨è„šæœ¬ï¼ˆæ¨èï¼‰

åˆ›å»ºå¯åŠ¨è„šæœ¬ `start_all.sh`:

```bash
#!/bin/bash

# å¯åŠ¨åç«¯
cd Desktop/kaoLong
source venv/bin/activate
python api_server.py &
BACKEND_PID=$!

# å¯åŠ¨å‰ç«¯
cd frontend
source ~/.nvm/nvm.sh
nvm use 22
npm run dev &
FRONTEND_PID=$!

echo "åç«¯ PID: $BACKEND_PID"
echo "å‰ç«¯ PID: $FRONTEND_PID"
echo "æŒ‰ Ctrl+C åœæ­¢æ‰€æœ‰æœåŠ¡"

# ç­‰å¾…ä¸­æ–­ä¿¡å·
trap "kill $BACKEND_PID $FRONTEND_PID; exit" INT
wait
```

ä½¿ç”¨æ–¹æ³•ï¼š

```bash
chmod +x start_all.sh
./start_all.sh
```

---

## ğŸŒ è®¿é—®åº”ç”¨

å¯åŠ¨æˆåŠŸåï¼Œåœ¨æµè§ˆå™¨ä¸­è®¿é—®ï¼š

**å‰ç«¯ç•Œé¢**: http://localhost:5173

**åç«¯ API**: http://localhost:5001

### API æ¥å£åˆ—è¡¨

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| GET | `/api/health` | å¥åº·æ£€æŸ¥ |
| GET | `/api/stats` | è·å–çŸ¥è¯†åº“ç»Ÿè®¡ |
| GET | `/api/subjects` | è·å–ç§‘ç›®åˆ—è¡¨ |
| POST | `/api/ask` | é—®ç­”æ¥å£ |
| POST | `/api/search` | çŸ¥è¯†æ£€ç´¢æ¥å£ |

---

## ğŸ“± ä½¿ç”¨è¯´æ˜

### å‰ç«¯åŠŸèƒ½

1. **èŠå¤©ç•Œé¢**
   - è¾“å…¥é—®é¢˜ï¼ŒAI ä¼šåŸºäºæ•™æå†…å®¹å›ç­”
   - æ”¯æŒå¤šè½®å¯¹è¯
   - æ˜¾ç¤ºå›ç­”æ¥æºå’Œé¡µç 

2. **ç§‘ç›®ç­›é€‰**
   - å¯ä»¥é€‰æ‹©ç‰¹å®šç§‘ç›®è¿›è¡Œæé—®
   - æ”¯æŒå…¨éƒ¨ç§‘ç›®æˆ–å•ä¸ªç§‘ç›®

3. **çŸ¥è¯†åº“ç»Ÿè®¡**
   - æ˜¾ç¤ºå„ç§‘ç›®çš„æ–‡æ¡£æ•°é‡
   - å®æ—¶æ›´æ–°

### ç¤ºä¾‹é—®é¢˜

- "ä»€ä¹ˆæ˜¯å·¥ç¨‹é€ ä»·ï¼Ÿ"
- "æœºç”µå·¥ç¨‹æ–½å·¥çš„ä¸»è¦æµç¨‹æ˜¯ä»€ä¹ˆï¼Ÿ"
- "å»ºè®¾å·¥ç¨‹æ‹›æŠ•æ ‡çš„æ³•å¾‹è§„å®šæœ‰å“ªäº›ï¼Ÿ"
- "é¡¹ç›®è¿›åº¦ç®¡ç†çš„æ–¹æ³•æœ‰å“ªäº›ï¼Ÿ"

---

## ğŸ”§ é…ç½®è¯´æ˜

### åç«¯é…ç½®

#### ä¿®æ”¹ API ç«¯å£

ç¼–è¾‘ `.env` æ–‡ä»¶ï¼š

```bash
API_PORT=5001  # ä¿®æ”¹ä¸ºå…¶ä»–ç«¯å£
```

#### ä¿®æ”¹ AI æ¨¡å‹

ç¼–è¾‘ `.env` æ–‡ä»¶ï¼š

```bash
# ä½¿ç”¨ OpenAI å®˜æ–¹
OPENAI_BASE_URL=https://api.openai.com/v1
OPENAI_MODEL=gpt-4o-mini

# æˆ–ä½¿ç”¨ DeepSeek
OPENAI_BASE_URL=https://api.deepseek.com/v1
OPENAI_MODEL=deepseek-chat
```

### å‰ç«¯é…ç½®

#### ä¿®æ”¹ API åœ°å€

ç¼–è¾‘ `frontend/src/App.jsx`:

```javascript
const API_BASE_URL = 'http://localhost:5001/api'  // ä¿®æ”¹ç«¯å£
```

#### ä¿®æ”¹å‰ç«¯ç«¯å£

ç¼–è¾‘ `frontend/vite.config.js`:

```javascript
export default defineConfig({
  plugins: [react()],
  server: {
    port: 5173  // ä¿®æ”¹ä¸ºå…¶ä»–ç«¯å£
  }
})
```

---

## ğŸ“¦ ç”Ÿäº§éƒ¨ç½²

### 1. æ„å»ºå‰ç«¯

```bash
cd frontend
npm run build
```

æ„å»ºäº§ç‰©åœ¨ `frontend/dist/` ç›®å½•

### 2. ä½¿ç”¨ç”Ÿäº§æœåŠ¡å™¨

#### åç«¯ä½¿ç”¨ Gunicorn

```bash
pip install gunicorn
gunicorn -w 4 -b 0.0.0.0:5001 api_server:app
```

#### å‰ç«¯ä½¿ç”¨ Nginx

é…ç½® Nginx åå‘ä»£ç†ï¼š

```nginx
server {
    listen 80;
    server_name your-domain.com;

    # å‰ç«¯é™æ€æ–‡ä»¶
    location / {
        root /path/to/frontend/dist;
        try_files $uri $uri/ /index.html;
    }

    # åç«¯ API ä»£ç†
    location /api/ {
        proxy_pass http://localhost:5001;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
```

---

## ğŸ› å¸¸è§é—®é¢˜

### 1. ç«¯å£è¢«å ç”¨

**é—®é¢˜**: `Address already in use`

**è§£å†³**:
```bash
# æŸ¥æ‰¾å ç”¨ç«¯å£çš„è¿›ç¨‹
lsof -i :5001

# æ€æ­»è¿›ç¨‹
kill -9 <PID>

# æˆ–ä¿®æ”¹ç«¯å£
```

### 2. CORS é”™è¯¯

**é—®é¢˜**: å‰ç«¯æ— æ³•è®¿é—®åç«¯ API

**è§£å†³**: æ£€æŸ¥ `api_server.py` ä¸­çš„ CORS é…ç½®ï¼š

```python
CORS(app, resources={
    r"/api/*": {
        "origins": ["http://localhost:5173"],  # æ·»åŠ å‰ç«¯åœ°å€
        "methods": ["GET", "POST", "OPTIONS"],
        "allow_headers": ["Content-Type"]
    }
})
```

### 3. Node.js ç‰ˆæœ¬ä¸å…¼å®¹

**é—®é¢˜**: `You are using Node.js 18.x.x. Vite requires Node.js version 20.19+ or 22.12+`

**è§£å†³**:
```bash
source ~/.nvm/nvm.sh
nvm install 22
nvm use 22
```

### 4. çŸ¥è¯†åº“æœªåˆå§‹åŒ–

**é—®é¢˜**: API è¿”å› "çŸ¥è¯†åº“æœªåˆå§‹åŒ–"

**è§£å†³**:
```bash
python init_knowledge_base.py
```

---

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

### åç«¯ä¼˜åŒ–

1. **ä½¿ç”¨ç¼“å­˜**
   - ç¼“å­˜å¸¸è§é—®é¢˜çš„å›ç­”
   - ä½¿ç”¨ Redis ç¼“å­˜çŸ¥è¯†åº“æ£€ç´¢ç»“æœ

2. **æ‰¹é‡å¤„ç†**
   - æ‰¹é‡å¤„ç†å¤šä¸ªé—®é¢˜
   - å¼‚æ­¥å¤„ç†é•¿æ—¶é—´ä»»åŠ¡

### å‰ç«¯ä¼˜åŒ–

1. **ä»£ç åˆ†å‰²**
   - ä½¿ç”¨ React.lazy æ‡’åŠ è½½ç»„ä»¶
   - è·¯ç”±çº§åˆ«çš„ä»£ç åˆ†å‰²

2. **èµ„æºä¼˜åŒ–**
   - å‹ç¼©å›¾ç‰‡å’Œé™æ€èµ„æº
   - ä½¿ç”¨ CDN åŠ é€Ÿ

---

## ğŸ”’ å®‰å…¨å»ºè®®

1. **API å¯†é’¥å®‰å…¨**
   - ä¸è¦å°† `.env` æ–‡ä»¶æäº¤åˆ° Git
   - ä½¿ç”¨ç¯å¢ƒå˜é‡ç®¡ç†æ•æ„Ÿä¿¡æ¯

2. **CORS é…ç½®**
   - ç”Ÿäº§ç¯å¢ƒé™åˆ¶å…è®¸çš„åŸŸå
   - ä¸è¦ä½¿ç”¨ `*` é€šé…ç¬¦

3. **è¾“å…¥éªŒè¯**
   - éªŒè¯ç”¨æˆ·è¾“å…¥
   - é˜²æ­¢ SQL æ³¨å…¥å’Œ XSS æ”»å‡»

---

## ğŸ“ å¼€å‘å»ºè®®

1. **ä»£ç è§„èŒƒ**
   - ä½¿ç”¨ ESLint å’Œ Prettier
   - éµå¾ª PEP 8 (Python) å’Œ Airbnb (JavaScript) è§„èŒƒ

2. **ç‰ˆæœ¬æ§åˆ¶**
   - ä½¿ç”¨ Git ç®¡ç†ä»£ç 
   - ç¼–å†™æ¸…æ™°çš„ commit ä¿¡æ¯

3. **æµ‹è¯•**
   - ç¼–å†™å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•
   - ä½¿ç”¨ pytest (åç«¯) å’Œ Jest (å‰ç«¯)

---

## ğŸ“ æ€»ç»“

ç°åœ¨ä½ å·²ç»æˆåŠŸéƒ¨ç½²äº†ä¸€å»ºæœºç”µå¤‡è€ƒ AI åŠ©æ‰‹çš„å‰åç«¯ç³»ç»Ÿï¼

- âœ… åç«¯ API æœåŠ¡å™¨è¿è¡Œåœ¨ `http://localhost:5001`
- âœ… å‰ç«¯ç•Œé¢è¿è¡Œåœ¨ `http://localhost:5173`
- âœ… çŸ¥è¯†åº“åŒ…å« 4709 æ¡è®°å½•
- âœ… æ”¯æŒæ™ºèƒ½é—®ç­”å’Œç§‘ç›®ç­›é€‰

ç¥ä½ å¤‡è€ƒé¡ºåˆ©ï¼ğŸ‰

